000100     IDENTIFICATION DIVISION.
000200     PROGRAM-ID. SQA-2020-ASSIGNMENT-PART-B.
000300     DATA DIVISION.
000400     WORKING-STORAGE SECTION.
000500     01 INT-INPUT PIC 9(4) COMP.
000600     01 CHAR-INPUT PIC X.
000700     01 I PIC 9(4) COMP.
000800     01 BILL PIC 9(4)V99 COMP-3.
000900     01 WS-CURRENT-DATE-DATA.
001000     05 WS-CURRENT-DATE.
001100     10 WS-CURRENT-YEAR         PIC 9(04).
001200     10 WS-CURRENT-MONTH        PIC 9(02).
001300     10 WS-CURRENT-DAY          PIC 9(02).
001400     05 WS-CURRENT-TIME.
001500     10 WS-CURRENT-HOURS        PIC 9(02).
001600     10 WS-CURRENT-MINUTE       PIC 9(02).
001700     10 WS-CURRENT-SECOND       PIC 9(02).
001800     10 WS-CURRENT-MILLISECONDS PIC 9(02).
001900     01 RANDOM-NUM PIC 9(2) COMP.
002000     PROCEDURE DIVISION.
002100     DISPLAY "ENTER AN INTEGER: "
002200     ACCEPT INT-INPUT
002300     MOVE 0 TO BILL
002400     PERFORM VARYING I FROM 1 BY 1 UNTIL I > INT-INPUT
002500     MOVE " " TO CHAR-INPUT
002600     PERFORM UNTIL CHAR-INPUT = "C" OR CHAR-INPUT = "T"  
002700-    OR CHAR-INPUT = "B"
002800     DISPLAY "ENTER A CHAR: T, C OR B: "
002900     ACCEPT CHAR-INPUT
003000     IF NOT(CHAR-INPUT = "C" OR CHAR-INPUT = "T"
003100-    OR CHAR-INPUT = "B")
003200     DISPLAY "NOT AN OPTION, TRY AGAIN."
003300     END-PERFORM
003400     EVALUATE TRUE
003500     WHEN CHAR-INPUT = "T"
003600     DISPLAY "YOU ENTERED T"
003700     ADD 1.85 TO BILL
003800     WHEN CHAR-INPUT = "C"
003900     DISPLAY "YOU ENTERED C"
004000     ADD 2.25 TO BILL
004100     WHEN OTHER
004200     DISPLAY "YOU ENTERED B"
004300     ADD 3.05 TO BILL
004400     END-EVALUATE
004500     END-PERFORM
004600     DISPLAY "TOTAL BILL: " BILL,
004700     MOVE FUNCTION CURRENT-DATE to WS-CURRENT-DATE-DATA
004800     COMPUTE RANDOM-NUM = (FUNCTION RANDOM (WS-CURRENT-DATE-DATA)
004900-    * 10) + 1
005000     DISPLAY "RANDOM NUMBER: " RANDOM-NUM
005100     IF RANDOM-NUM = 1
005200     MOVE 0 TO BILL
005300     DISPLAY "DISCOUNT APPLIED: BILL SET TO 0"
005400     IF RANDOM-NUM >= 2 AND RANDOM-NUM <= 6
005500     COMPUTE BILL = BILL / 2
005600     DISPLAY "DISCOUNT APPLIED: BILL HALVED"
005700     ELSE
005800     DISPLAY "NO DISCOUNT APPLIED"
005900     END-IF
006000     DISPLAY "FINAL BILL: " BILL
006100     STOP RUN.
